---
import Layout from '../layouts/Layout.astro';
import Map from '../components/Map.astro';

// Handle auth import gracefully in case of backend issues
let session = null;
try {
    const { auth } = await import('@backend/auth');
    session = await auth.api.getSession({
        headers: Astro.request.headers,
    });
} catch (error) {
    console.warn('Auth service unavailable, allowing map access:', error.message);
}

// Only redirect if auth is working and no session exists
if (session === false) {
    return Astro.redirect('/sign-in');
}
---

<Layout title="Map - Tail Mates">
	<div class="map-page">
		<Map />
	</div>
</Layout>

<style>
	/* Ensure full-page layout for the map */
	.map-page {
		position: fixed;
		top: 0;
		left: 0;
		width: 100vw;
		height: 100vh;
		z-index: 1;
	}
</style>